<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>OTS/RDS 数据库读取示例</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
</head>
<body>
<h1>RDS/OTS 数据库读取示例</h1>
<p>连接数据库代码：api/db_config.js</p>
<p>需要在「应用配置」中添加以下环境变量</p>
<pre>
OTS_ENDPOINT=https://todolist.cn-shanghai.ots.aliyuncs.com
OTS_INSTANCE=todolist
OTS_ACCESSKEY=LTAI4G1j3U8ue1yT3g6Tg1TG
OTS_SECRET=WB8Ev6zMHoKQnUSLp8V4zP7xeAgbWC
RDS_HOST=rm-uf6y14uhf0080yfrb7o.mysql.rds.aliyuncs.com
RDS_DBNAME=faas-test
RDS_USERNAME=faas_db_test
RDS_PASSWORD=YY6i8Jp7W_mtYxU
</pre>
<p>读取数据库代码：api/db_get.js</p>
<p>以下内容读取自云开发平台 todo 示例数据库(RDS)</p>
<hr />
<div id="blog" class="looking-area pt-110 pb-40 gray-bg">
	<div class="row">
		<div class="col-xl-12">
			<div class="section-title text-center">
				<h2>Latest Posts</h2>
			</div>
		</div>
	</div>
	<div id="blog-list" class="row no-gutters">

		<div class="col-xl-4 col-lg-4 col-md-6">
			<div class="looking-wrapper text-center">
				<div class="blog-column">
					<h1>loading blog title</h1>
					<p>loading blog summary</p>
				</div>
			</div>
		</div>
    
	</div>
</div>
<!-- JS here -->
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $.ajax({url:"/api/db_get",success:function(result){
      var list = (result && result.list) ? result.list : (result ? result : []);
      var bloglist = [];
      $.each(list, function(index,data){
        var html = ' <div class="col-xl-4 col-lg-4 col-md-6">\
          <div class="looking-wrapper text-center">\
            <div class="blog-column">\
              <h1>'+ data.todo +'</h1>\
              <p>'+ data.gmt_create +'</p>\
              <a class="btn" href="/api/db_get?isots=true">查看 OTS 数据库数据</a>\
            </div>\
          </div>\
        </div>';
        bloglist.push(html);
      });
      $("#blog-list").html(bloglist.join(''));
  }});
});
</script>
</body>
</html>